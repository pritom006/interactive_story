{% extends 'base.html' %}

{% block title %}Story Analytics{% endblock %}

{% block content %}
<div class="analytics-container">
    <h2 class="analytics-header">Story Analytics for "{{ story.title }}"</h2>

    <table class="analytics-table">
        <thead>
            <tr>
                <th>Node</th>
                <th>Views</th>
                <th>Time Spent (H:M:S)</th>
                <th>Choices Made</th>
            </tr>
        </thead>
        <tbody>
            {% for node in nodes %}
            <tr>
                <td>{{ node.title }}</td>
                <td>{{ node.views }}</td>
                <td>{{ node.formatted_time_spent }}</td> <!-- Use formatted time spent -->
                <td>{{ node.choices_from.count }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4">No data available</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="summary">
        <p>Total Time Spent on Story: <span>{{ formatted_total_time }}</span></p>
    </div>

    <a href="{% url 'story_detail' story.pk %}" class="analytics-btn">Back to Story</a>
</div>
{% endblock %}
